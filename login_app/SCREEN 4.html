<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Progress Tracker • Dashboard</title>
    <style>
        :root{
            --bg: #0d1117;
            --panel: #161b22;
            --text: #c9d1d9;
            --muted: #8b949e;
            --brand: #58a6ff;
            --brand-2: #38c47f;
            --accent: #a371f7;
            --border: rgba(255, 255, 255, .15);
            --radius: 16px;
            --shadow: 0 10px 30px rgba(0,0,0,.3);
            --gradient: linear-gradient(135deg, var(--brand), var(--accent));
        }
        *{box-sizing:border-box}
        html,body{height:100%}
        body{
            margin:0;
            font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
            background: radial-gradient(1000px 500px at 10% -10%, #1a2230 0%, transparent 60%),
                        radial-gradient(800px 400px at 100% 10%, #15202b 0%, transparent 60%),
                        var(--bg);
            color:var(--text);
            letter-spacing:.2px;
            overflow-x: hidden;
            transition: background-color .3s;
        }

        /* Animations */
        @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
        @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(88,166,255,.4)}70%{box-shadow:0 0 0 10px rgba(88,166,255,0)}100%{box-shadow:0 0 0 0 rgba(88,166,255,0)}}
        
        /* Layout */
        .container{
            max-width:1180px;
            margin:24px auto 48px;
            padding:0 16px;
            animation: fadeIn .8s ease-out;
        }
        header{
            display:flex;align-items:center;justify-content:space-between;
            gap:16px;margin-bottom:16px;
        }
        .brand{display:flex;align-items:center;gap:14px;min-width:0}
        .logo{
            width:46px;height:46px;border-radius:12px;
            background: var(--gradient);
            display:grid;place-items:center;color:white;font-weight:800;
            box-shadow: var(--shadow);
            flex:0 0 46px;
            animation: pulse 2s infinite;
        }
        .title h1{margin:0;font-size:22px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .title p{margin:2px 0 0;color:var(--muted);font-size:14px}
        .actions{display:flex;gap:10px;flex-wrap:wrap}
        .btn{
            padding:10px 14px;border:1px solid var(--border);
            background:linear-gradient(180deg,#1f2835,#161b22);
            color:var(--text);border-radius:12px;cursor:pointer;font-weight:600;
            transition:.15s transform, .15s border-color, .3s background-color;
            position:relative; overflow:hidden;
        }
        .btn:hover{transform:translateY(-2px);border-color:#30435f}
        .btn:active{transform:translateY(0)}
        .btn::before{
            content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;
            background:rgba(255,255,255,.1);transition:left .3s;
        }
        .btn:hover::before{left:0}
        .btn.success{background:linear-gradient(135deg, var(--brand-2), #1f9e5c); border:none}
        .btn.primary{background:var(--gradient); border:none}

        /* Banner */
        .banner{
            border:1px solid var(--border);
            background: linear-gradient(180deg, #1f2835, #161b22);
            padding:14px 16px;border-radius:14px;margin:12px 0 18px;
            display:flex;align-items:center;gap:12px;justify-content:space-between;
        }
        .badge{
            font-size:11px;font-weight:800;letter-spacing:.4px;text-transform:uppercase;
            padding:6px 8px;border-radius:8px;background:#202b36;color:#9ec2ff;border:1px solid #2f3a4b;
        }
        .banner-main{display:flex;align-items:center;gap:12px;min-width:0}
        .banner-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

        /* KPIs */
        .kpis{
            display:grid;
            grid-template-columns: repeat(auto-fit, minmax(210px,1fr));
            gap:14px;margin:16px 0 22px;
        }
        .card{
            background:linear-gradient(180deg,#1b2531,#121a24);
            border:1px solid var(--border);border-radius:var(--radius);
            padding:16px; box-shadow:var(--shadow);
            display:flex;flex-direction:column;gap:6px;min-height:110px;
            transition:transform .2s;
        }
        .card:hover{transform:translateY(-4px)}
        .card h3{margin:0;font-size:13px;color:var(--muted);font-weight:700;letter-spacing:.3px}
        .big{font-size:26px;font-weight:800;margin:2px 0}
        .hint{font-size:12px;color:var(--muted)}

        /* Main grid */
        .grid{
            display:grid;grid-template-columns: 1.45fr .85fr;gap:16px;
        }
        .panel{
            background:linear-gradient(180deg,#1b2531,#121a24);
            border:1px solid var(--border);border-radius:var(--radius);
            padding:16px;box-shadow:var(--shadow);
            min-width:0;
        }
        .panel h2{margin:0 0 10px;font-size:18px}
        .muted{color:var(--muted);font-size:14px;margin:6px 0 12px}

        /* Courses */
        .list{display:grid;gap:10px}
        .course{
            display:flex;gap:14px; align-items:center;
            padding:12px;border-radius:12px;border:1px solid var(--border);
            background:linear-gradient(180deg,#1f2835,#161b22);
            transition:transform .2s, box-shadow .2s;
        }
        .course:hover{transform:scale(1.02);box-shadow:0 8px 20px rgba(0,0,0,.4)}
        .course .icon{
            width:42px;height:42px;border-radius:12px;flex:0 0 42px;
            display:grid;place-items:center;font-weight:800;
            color:var(--brand);border:1px solid rgba(88,166,255,.2);
            background:linear-gradient(135deg, rgba(88,166,255,.1), rgba(163,113,247,.1));
        }
        .course-main{flex:1;min-width:0}
        .course-row{display:flex;align-items:center;gap:10px;min-width:0}
        .course-title{font-weight:700;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .course-meta{color:var(--muted);font-size:13px;margin-left:auto;white-space:nowrap}
        .progress{
            width:100%;height:10px;border:1px solid #1c2c4d;background:#0a1326;
            border-radius:999px;overflow:hidden;margin-top:8px;
        }
        .bar{
            height:100%;width:0%;
            background:linear-gradient(90deg, var(--brand), var(--accent), var(--brand-2));
            transition:width .5s ease;
        }
        .course-foot{display:flex;align-items:center;gap:10px;margin-top:6px;flex-wrap:wrap}
        .pct{font-size:12px;color:var(--muted)}
        .course .btn{padding:8px 10px}

        /* Activity list */
        .list-item{
            border:1px solid var(--border); border-radius:12px; padding:10px 12px;
            background:linear-gradient(180deg,#1f2835,#161b22);
            display:flex;justify-content:space-between;gap:8px; align-items:center;
            transition:transform .2s;
        }
        .list-item:hover{transform:translateX(5px)}
        .tag{font-size:11px;padding:4px 8px;border-radius:999px;border:1px solid #2f3a4b;background:#202b36;color:#9ec2ff}
        .time{color:var(--muted);font-size:12px}

        /* Toast */
        .toast{
            position:fixed; right:16px; bottom:16px; z-index:9999;
            padding:14px 16px; border-radius:12px; border:1px solid var(--border);
            background:linear-gradient(135deg,#1f2835,#161b22); box-shadow:var(--shadow);
            display:none; min-width:260px;
        }
        .toast.show{display:block; animation: pop .18s ease}
        @keyframes pop{from{transform:translateY(6px);opacity:0}to{transform:none;opacity:1}}

        /* Responsive */
        @media (max-width: 980px){
            .grid{grid-template-columns:1fr}
        }
        @media (max-width: 620px){
            header{flex-direction:column;align-items:flex-start;gap:10px}
            .actions{width:100%}.btn{flex:1}
            .banner{flex-direction:column;align-items:flex-start;gap:8px}
            .banner-main{width:100%}
            .kpis{gap:10px}
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="brand">
                <div class="logo">GL</div>
                <div class="title">
                    <h1>GAINZ LOOP — Progress Dashboard</h1>
                    <p>Track your learning journey across courses.</p>
                </div>
            </div>
            <div class="actions">
                <button id="btn-mark-next" class="btn success">Mark Next Module Completed</button>
                <button id="btn-reset" class="btn">Reset Demo Data</button>
            </div>
        </header>

        <div id="banner" class="banner" role="status" aria-live="polite">
            <div class="banner-main">
                <span class="badge">Notification</span>
                <div id="banner-text" class="banner-text">Welcome back! Keep your progress going!</div>
            </div>
        </div>

        <section class="kpis" aria-label="Summary">
            <div class="card"><h3>Total Courses</h3><div id="kpi-courses" class="big">—</div><div class="hint" id="kpi-courses-trend"></div></div>
            <div class="card"><h3>Overall Progress</h3><div id="kpi-overall" class="big">—%</div><div class="hint">Average across all courses</div></div>
            <div class="card"><h3>Completed Modules</h3><div id="kpi-completed" class="big">—</div><div class="hint" id="kpi-totalmod">of — total</div></div>
            <div class="card"><h3>Last Activity</h3><div id="kpi-last" class="big">—</div><div class="hint">Most recent action</div></div>
            <div class="card"><h3>Estimated Time Left</h3><div id="kpi-timeleft" class="big">—</div><div class="hint">Based on your pace</div></div>
        </section>

        <div class="grid">
            <section class="panel" aria-label="Your Courses">
                <h2>Your Courses</h2>
                <p class="muted">Completed vs total modules, percentage, and next module suggestion.</p>
                <div id="courses" class="list"></div>
            </section>

            <aside class="panel" aria-label="Next Up">
                <h2>Next Up</h2>
                <p id="next-up" class="muted">We’ll suggest your next module based on your progress.</p>
                <h2 style="margin-top:16px;">Recent Activity</h2>
                <div id="recent" class="list" aria-live="polite"></div>
            </aside>
        </div>
    </div>

    <div id="toast" class="toast" role="status" aria-live="polite"></div>

    <script>
        /* ---------- Demo data ---------- */
        const demoCourses = [
            {
                id: 'js-basics',
                title: 'JavaScript Basics',
                modules: [
                    'Intro to JS','Variables & Types','Operators','Control Flow','Functions',
                    'Arrays','Objects','DOM Basics','Events','Project: Quiz App'
                ],
                completed: 6, lastActivity: null
            },
            {
                id: 'python-core',
                title: 'Python Programming',
                modules: [
                    'Setup & Syntax','Control Flow','Functions','Collections','OOP',
                    'File I/O','Modules & Venv','Data Visualization','Testing','Final Project'
                ],
                completed: 3, lastActivity: null
            },
            {
                id: 'power-bi',
                title: 'Power BI',
                modules: [
                    'Intro & Interface','Data Import','Data Modeling','DAX Basics','Visualizations',
                    'Dashboards','Power Query','Publishing','Sharing','Capstone Dashboard'
                ],
                completed: 2, lastActivity: null
            }
        ];

        const STORAGE_STATE = 'progress_state_v2';
        const STORAGE_LOG   = 'progress_log_v2';  // timestamps of learning actions

        function loadState(){
            const saved = localStorage.getItem(STORAGE_STATE);
            const savedLog = localStorage.getItem(STORAGE_LOG);
            if(saved && savedLog){
                try { return { state: JSON.parse(saved), log: JSON.parse(savedLog) }; } catch(e){}
            }
            // seed
            const seeded = structuredClone(demoCourses).map((c,i)=>({
                ...c, completed: Math.min(c.completed, c.modules.length),
                lastActivity: Date.now() - (i+1)*3600*1000
            }));
            const log = [];
            // create a few past actions for pace
            const now = Date.now(), day = 24*3600*1000;
            log.push(now - day*2); // two days ago
            log.push(now - day);   // yesterday
            log.push(now - 30*60*1000); // 30 mins ago
            saveState(seeded, log);
            return { state: seeded, log };
        }
        function saveState(state, log){
            localStorage.setItem(STORAGE_STATE, JSON.stringify(state));
            localStorage.setItem(STORAGE_LOG, JSON.stringify(log));
        }

        let { state, log } = loadState();

        /* ---------- Helpers ---------- */
        const fmtPct = (n)=> Math.round(n*100)/100;

        function overallStats(courses){
            let total=0, done=0, last=0;
            courses.forEach(c=>{
                total += c.modules.length;
                done  += Math.min(c.completed, c.modules.length);
                last = Math.max(last, c.lastActivity||0);
            });
            return { total, done, overall: total? (done/total*100) : 0, last };
        }

        function timeAgo(ts){
            if(!ts) return '—';
            const diff = Date.now()-ts;
            const mins = Math.floor(diff/60000);
            if(mins<1) return 'just now';
            if(mins<60) return `${mins}m ago`;
            const hrs = Math.floor(mins/60);
            if(hrs<24) return `${hrs}h ago`;
            const days = Math.floor(hrs/24);
            return `${days}d ago`;
        }

        // Estimate time left from pace (modules/day) using activity count as events
        function estimateTimeLeft(courses, activityLog){
            const { total, done } = overallStats(courses);
            const remaining = total - done;
            if(remaining <= 0) return "Completed";
            if(activityLog.length < 2) return "—";

            const first = Math.min(...activityLog);
            const last  = Math.max(...activityLog);
            const days = Math.max((last - first)/(24*3600*1000), 0.05);
            const pace = activityLog.length / days; // actions per day
            if(pace <= 0) return "—";

            const daysLeft = remaining / pace;
            if(daysLeft < 1/24) { // < 1 hour
                const mins = Math.round(daysLeft*24*60);
                return `${Math.max(mins,1)} min`;
            }
            if(daysLeft < 1) {
                const hrs = Math.round(daysLeft*24);
                return `${hrs} h`;
            }
            const whole = Math.floor(daysLeft);
            const hours = Math.round((daysLeft - whole)*24);
            return `${whole}d ${hours}h`;
        }

        /* ---------- UI ---------- */
        const coursesEl = document.getElementById('courses');
        const recentEl  = document.getElementById('recent');
        const nextUpEl  = document.getElementById('next-up');

        function render(){
            const k = overallStats(state);
            document.getElementById('kpi-courses').textContent = state.length;
            document.getElementById('kpi-overall').textContent = `${fmtPct(k.overall)}%`;
            document.getElementById('kpi-completed').textContent = k.done;
            document.getElementById('kpi-totalmod').textContent = `of ${k.total} total`;
            document.getElementById('kpi-last').textContent = timeAgo(k.last);
            document.getElementById('kpi-courses-trend').textContent = k.overall >= 50 ? 'Nice! Over halfway average.' : 'You’re warming up.';

            const eta = estimateTimeLeft(state, log);
            document.getElementById('kpi-timeleft').textContent = eta;

            // Courses
            coursesEl.innerHTML = '';
            state.forEach(c=>{
                const pct = Math.min(c.completed, c.modules.length)/c.modules.length*100;
                const nextIndex = Math.min(c.completed, c.modules.length-1);
                const nextTitle = c.completed >= c.modules.length ? 'All modules completed' : c.modules[nextIndex];

                const wrap = document.createElement('div');
                wrap.className = 'course';
                wrap.innerHTML = `
                    <div class="icon">${c.title.split(' ').map(w=>w[0]).join('').slice(0,3)}</div>
                    <div class="course-main">
                        <div class="course-row">
                            <h3 class="course-title" title="${c.title}">${c.title}</h3>
                            <div class="course-meta"><strong>${c.completed}</strong>/<span>${c.modules.length}</span> modules</div>
                        </div>
                        <div class="progress" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="${Math.round(pct)}">
                            <div class="bar" style="width:${pct}%"></div>
                        </div>
                        <div class="course-foot">
                            <div class="pct">${Math.round(pct)}% • Next: <em>${nextTitle}</em></div>
                        </div>
                    </div>
                    <div>
                        <button class="btn" data-action="complete" data-id="${c.id}" ${c.completed>=c.modules.length?'disabled':''}>Complete next</button>
                    </div>
                `;
                coursesEl.appendChild(wrap);
            });

            // Recent activity (last 4 events by course recency)
            const recent = [...state].sort((a,b)=>(b.lastActivity||0)-(a.lastActivity||0)).slice(0,4);
            recentEl.innerHTML = '';
            recent.forEach(c=>{
                const pct = Math.round(Math.min(c.completed, c.modules.length)/c.modules.length*100);
                const li = document.createElement('div');
                li.className='list-item';
                li.innerHTML = `
                    <div>
                        <div style="font-weight:700">${c.title}</div>
                        <div class="time">Updated ${timeAgo(c.lastActivity)}</div>
                    </div>
                    <span class="tag">${pct}%</span>
                `;
                recentEl.appendChild(li);
            });

            // Next up: lowest completion percentage
            const candidate = [...state]
                .map(c=>({c, pct: Math.min(c.completed, c.modules.length)/c.modules.length}))
                .filter(x=>x.pct<1).sort((a,b)=>a.pct-b.pct)[0];
            nextUpEl.textContent = candidate
                ? `${candidate.c.title}: ${candidate.c.modules[Math.min(candidate.c.completed, candidate.c.modules.length-1)]}`
                : 'You’ve completed everything. Great job! 🎉';
        }

        /* ---------- Notifications ---------- */
        const bannerText = document.getElementById('banner-text');
        const toast = document.getElementById('toast');
        function showBanner(msg){ bannerText.textContent = msg; }
        function showToast(msg){
            toast.textContent = msg;
            toast.classList.add('show');
            setTimeout(()=> toast.classList.remove('show'), 2600);
        }
        function checkMilestones(prevOverall, nextOverall){
            const thresholds = [25,50,75,100];
            const crossed = thresholds.find(t => prevOverall < t && nextOverall >= t);
            if(crossed){
                showToast(`Milestone reached: ${crossed}% overall`);
                showBanner(crossed===100 ? 'You finished all modules — amazing! 🏆' : `You’ve completed ${crossed}% – keep going! 💪`);
            }
        }

        /* ---------- Actions ---------- */
        document.addEventListener('click', (e)=>{
            const btn = e.target.closest('button[data-action="complete"]');
            if(!btn) return;
            const id = btn.getAttribute('data-id');
            const course = state.find(x=>x.id===id);
            if(!course) return;

            const prevOverall = overallStats(state).overall;

            if(course.completed < course.modules.length){
                course.completed += 1;
                const ts = Date.now();
                course.lastActivity = ts;
                log.push(ts);            // record activity for pace
                saveState(state, log);
                render();
                checkMilestones(prevOverall, overallStats(state).overall);
                const justDone = course.modules[course.completed-1];
                showToast(`Marked complete: ${course.title} • ${justDone}`);
            }
        });

        document.getElementById('btn-mark-next').addEventListener('click', ()=>{
            const candidate = [...state]
                .map(c=>({c, pct: Math.min(c.completed, c.modules.length)/c.modules.length}))
                .filter(x=>x.pct<1).sort((a,b)=>a.pct-b.pct)[0];
            if(!candidate) return showToast('All done already! 🎉');
            const id = candidate.c.id;
            document.querySelector(`button[data-id="${id}"]`)?.click();
        });

        document.getElementById('btn-reset').addEventListener('click', ()=>{
            localStorage.removeItem(STORAGE_STATE);
            localStorage.removeItem(STORAGE_LOG);
            ({ state, log } = loadState());
            render();
            showToast('Demo data reset');
            showBanner('Welcome back! Keep your progress going!');
        });

        // Initial render + gentle nudge
        render();
        setTimeout(()=> showToast('Tip: Click “Complete next” to see progress & ETA update'), 800);
    </script>
</body>
</html>